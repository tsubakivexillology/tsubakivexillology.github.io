<!DOCTYPE html>
<html lang="en">
<head data-load="/html/csslib.html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="旗章製造收錄了以台灣為本的各式旗幟與紋章創作。">
    <meta name="keywords" content="旗章製造,旗章,旗幟,國旗,市旗,縣旗,旗幟學,紋章,和紋,家紋,市徽,市章,縣徽,縣章,設計">
    <meta name="robots" content="index,follow">

    <!-- Open Graph protocol -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="旗章製造">
    <meta property="og:url" content="https://tsubakivexillology.github.io">
    <meta property="og:image" content="https://tsubakivexillology.github.io/images/tsubaki-512.png">
    <meta property="og:description" content="旗章製造收錄了以台灣為本的各式旗幟與紋章創作。">

    <!-- Twitter. Yes, it is correctly called Twitter -->
    <meta name="twitter:site" content="@_inori_tsubaki" />
    <meta name="twitter:title" content="旗章製造" />
    <meta name="twitter:card" content="https://tsubakivexillology.github.io/images/tsubaki-512.png" />
    <meta name="twitter:description" content="旗章製造收錄了以台灣為本的各式旗幟與紋章創作。" />
    <style>
        #windless-hanged-flag-display {
            height: 21em;
            margin-top: 4em;
        }
        #windless-hanged-flag-ctn {
            position: relative;
            transform: rotate(60deg);
        }
        #windless-hanged-flag {
            min-width: 180px;
            max-width: 270px;
            clip-path: polygon(0 0, 100% 42%, 100% 100%, 54% 100%);
            -webkit-clip-path: polygon(0 0, 100% 42%, 100% 100%, 54% 100%);
        }
        #windless-hanged-flag-border {
            position: absolute;
            background: black;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            clip-path: polygon(0 0, 100% 42%, 100% 100%, 54% 100%);
            -webkit-clip-path: polygon(0 0, 100% 42%, 100% 100%, 54% 100%);
        }
        #windless-hanged-flag-pole {
            position: absolute;
            width: 0.75em;
            height: 20em;
            background-color: black;
        }
        .color-tag-child {
            display: inline-block !important;
            transform: rotate(45deg);
            width: 3.5em;
            height: 3.5em;
            border-radius: 0.5em;
        }
        /* md-max */
        @media (max-width: 768px) {
            .color-tag-ctn {
                margin-left: -0.25em;
                margin-right: -0.25em;
            }
            .color-tag-text {
                font-size: x-small !important;
            }
        }
        /* md-min */
        @media (min-width: 768px) {
            .color-tag-child {
                width: 5em;
                height: 5em;
            }
        }
        hr {
            border: 1px solid black;
            width: 100%;
        }
    </style>
    <title>旗章製造 - 旗幟</title>
</head>
<body style="overflow-x: hidden;">
    
    <div data-load="/html/banner_detail.html"></div>
    
    <div data-title="body" class="container d-flex flex-wrap justify-content-center W-100 mb-5">

        <nav aria-title="breadcrumb" class="w-md-75 w-100 py-1 noto-sans-tc">
            <ol class="breadcrumb"></ol>
        </nav>

        <div data-title="display" class="d-flex flex-wrap justify-content-center align-items-center w-md-75 w-100 py-5 mt-5">
            
            <div class="d-flex flex-wrap justify-content-center align-items-center w-100 mb-5">
                <img class="main-image modal-trigger-image mw-100 border mb-3" data-type="flag">

                <div class="d-flex justify-content-center flag-colors w-100 noto-sans-tc mt-5 mb-5"></div>

                <div class="d-block bg-black pt-1 mb-2 w-100"></div>
                
                <h1 class="flag-title noto-sans-tc fw-800 w-100 text-center mb-5"></h1>
                
                <div class="position-relative">
                    <div class="description noto-sans-tc w-100 text-start fs-5 invisible" id="description-placeholder">旗的介紹還沒完成，但或許過一段時間它就會自己長出來了。</div>
                    <div class="description noto-sans-tc w-100 text-start fs-5 position-absolute top-0 left-0" id="description">旗的介紹還沒完成，但或許過一段時間它就會自己長出來了。</div>
                </div>
            </div>

            <div data-title="windless-hanged-display">
                <div id="windless-hanged-flag-display">
                    <div class="d-flex justify-content-center">
                        <div id="windless-hanged-flag-pole"></div>
                    </div>
                    <div id="windless-hanged-flag-ctn">
                        <div id="windless-hanged-flag-border"></div>
                        <img id="windless-hanged-flag" data-type="flag">
                    </div>
                </div>
                <div class="noto-sans-tc text-center mb-3">
                    旗在無風狀態下的樣子
                </div>
                <div data-title="flag-waver" class="w-100 text-center">
                    <a class="btn btn-dark text-white noto-sans-tc" id="flag-waver-link">
                        在 FlagWaver 上檢視<i class="bi bi-flag-fill ms-2"></i>
                    </a>
                </div>
            </div>
        </div>

        <span class="w-100 mb-5" id="related-entities">
            <hr class="mb-2">
            <div class="fos w-100 text-center fs-3 noto-sans-tc fw-800">相關作品</div>
        </span>

        <div data-title="flag-display" class="w-100">
            <div class="d-flex justify-content-center flex-wrap" id="flag-ctn"></div>
        </div>

        <!-- <div data-title="neighbors" class="fos mw-100 mb-5">
            <div class="text-center">
                <span class="w-100 w-md-50 text-center my-3" id="prev-flag">
                    <a class="text-dark text-nowrap mx-2 fs-4">
                        <i class="bi bi-arrow-left-square-fill me-2"></i>
                        <span class="noto-sans-tc text-nowrap"></span>
                    </a>
                </span>
                <span class="w-100 w-md-50 text-center my-3" id="next-flag">
                    <a class="text-dark text-nowrap mx-2 fs-4">
                        <span class="noto-sans-tc text-nowrap"></span>
                        <i class="bi bi-arrow-right-square-fill ms-2"></i>
                    </a>
                </span>
            </div>
        </div> -->

        <div data-title="back-to-list" class="w-100 mb-5">
            <div class="d-flex justify-content-center">
                <a href="/category-flag.html" class="btn btn-tsubaki noto-sans-tc fw-800 text-nowrap px-3">
                    <i class="bi bi-grid-fill me-2"></i>回到列表
                </a>
            </div>
        </div>

    </div>

    <div data-load="/html/footer.html" id="footer"></div>
    <div data-load="/html/image_modal.html"></div>
    
    <script src="/js/load_html.js"></script>
    <!-- jquery -->
    <script src="/plugins/jquery/jquery-3.7.1.min.js"></script>
    <!-- bootstrap -->
    <script src="/plugins/bootstrap/bootstrap.min.js"></script>
    <script src="/plugins/bootstrap/bootstrap.bundle.min.js"></script>
    <!-- typewriter -->
    <script src="/js/typewriter.js"></script>
    <!-- fade-in -->
    <script src="/js/fadeInOnScroll.js"></script>
    <!-- flag data -->
    <script src="/js/flag_data.js"></script>
    <script>
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const flagName = urlParams.get("name");
        
        var flag = getFlagByEn(flagName);
        // const neighbors = getNeighborFlags(flagName);
        
        if (flag == null) {
            window.location.href = "/404.html";
        }
        $(function() {
            onDocLoaded(function() {
                flag.desc = getFlagDesc(flag.en);
                flag.colors = getFlagColors(flag.en);
                setMainImage(flag);
                setHangedFlag(flag);
                setBreadcrumb(flag);

                $("#prev-flag").hide();
                $("#next-flag").hide();
                
                const relatedFlags = getRelatedFlags(flagName);

                if (!relatedFlags.length) {
                    $("#related-entities").hide();
                }
                if (relatedFlags != undefined && relatedFlags.length) {
                    $("div[data-title='flag-display']").addClass("mb-5");
                    for (var relatedFlag of relatedFlags) {
                        appendImage(relatedFlag, flagConfig);
                    }
                }
                // show modal when left click on images
                refreshAllImageModals();

                fadeInOnScrollAll();

                // set neighbors
                // if (neighbors.prev != null) {
                //     var href = `/flag-detail.html?name=${neighbors.prev.en}`;
                //     $("#prev-flag").show();
                //     $("#prev-flag > a").attr("href", href);
                //     $("#prev-flag > a > span").html(neighbors.prev.md);
                // }
                // if (neighbors.next != null) {
                //     var href = `/flag-detail.html?name=${neighbors.next.en}`;
                //     $("#next-flag").show();
                //     $("#next-flag > a").attr("href", href);
                //     $("#next-flag > a > span").html(neighbors.next.md);
                // }
                var callback = "https://" +  window.location.host + flagConfig.dir + flag.en + ".png";
                $("#flag-waver-link").bind("click", () => {
                    window.open(`https://krikienoid.github.io/flagwaver/#?src=${encodeURI(callback)}`, `_blank`).focus();
                });
            });
        });

        function refreshAllImageModals() {
            // show modal when left click on images
            $(".modal-trigger-image").on("mousedown", function(event) {
                // only trigger on left click
                if (event.which != 1) return;
                var imgSrc = $(this).attr("src");
                if (!$("#image-modal").hasClass("modal-lg")) {
                    $("#image-modal").addClass("modal-lg");
                }
                $("#modal-image-src").attr("src", imgSrc);
                $("#image-modal-trigger").click();
            })
        }

        function setMainImage(flag) {
            $(".main-image").attr("src", flagConfig.dir + flag.en + ".png");
            $(".main-image").attr("alt", flag.title);

            $(".flag-title").html(flag.title_md);

            if (flag.colors) {
                var flagColors = flag.colors.split(",");
                for (var flagColor of flagColors) {
                    flagColor = flagColor.toUpperCase();
                    var childClass = "";
                    var styles = `background-color:#${flagColor};`;
                    if (flagColor === "FFFFFF") {
                        childClass = " border border-4";
                    }
                    $(".flag-colors").append(
                        `<div class="color-tag-ctn d-flex justify-content-center flex-wrap mx-md-2" style="max-width:4em;">` +
                            `<span class="color-tag text-center d-inline">` +
                                `<span class="color-tag-child${childClass}" style="${styles}"></span>` +
                            `</span>` +
                            `<span class="color-tag-text mt-3 me-1" style="font-size:smaller">#${flagColor}</span>` +
                        `</div>`
                    );
                }
            }
            let descPlaceholderEle = document.getElementById("description-placeholder");

            // default desc is in html
            let descEle = document.getElementById("description");
            let descText = "";

            // if desc exists
            if (flag.desc) {
                descText = flag.desc;

            // if flag inherits desc
            } else {
                do {
                    if (flag.desc_inherit !== true) break;
                    const parentFlag = getFlagByEn(flag.parent);
                    if (!parentFlag) break;
                    if (!parentFlag.desc) break;
                    descText = parentFlag.desc;
                } while (false);
            }
            if (descText) {
                descPlaceholderEle.innerHTML = descText;
            }
            // apply typewriter effect to element
            typewriter(descEle, descText);
            
            // the typing effect constantly resets the element,
            // therefore the modal function can be applied to element
            // only after typing effect is complete. 
            descEle.addEventListener("typingComplete", function() {
                refreshAllImageModals();
            });
        }

        function setHangedFlag(flag) {
            $("#windless-hanged-flag").attr("src", flagConfig.dir + flag.en + ".png");
            $("#windless-hanged-flag").attr("alt", flag.title);
        }

        function setBreadcrumb(flag) {
            do {
                if (flag.en === flagName) {
                    $(".breadcrumb").prepend(`<li class="breadcrumb-item text-secondary">${flag.md}</li>`);
                } else {
                    $(".breadcrumb").prepend(`<li class="breadcrumb-item"><a href="/flag-detail.html?name=${flag.en}" class="text-secondary">${flag.title_md}</a></li>`);
                }
                flag = getFlagByEn(flag.parent);
            } while (flag !== null);
            $(".breadcrumb").prepend(`<li class="breadcrumb-item"><a href="/category-flag.html" class="text-secondary">旗幟</a></li>`);
            $(".breadcrumb").prepend(`<li class="breadcrumb-item"><a href="/index.html?scrollTo=cards" class="text-secondary"></i>首頁</a></li>`);
            $(".breadcrumb").prepend(`<li class="breadcrumb-item"><i class="tbk tbk-taiwan text-secondary"></i></li>`);
        }

        function setMeta(flag) {
            const imageSrc = "https://" +  window.location.host + flagConfig.dir + flag.en + ".png";
            const desc = flag.desc ?? "旗章製造收錄了台灣的各式旗幟與紋章創作。";

            setSingleMeta("name", "keywords", `旗章製造,旗章,旗幟,國旗,市旗,縣旗,旗幟學,紋章,和紋,家紋,市徽,市章,縣徽,縣章,設計,${flag.md}`);
            setSingleMeta("name", "image", imageSrc);
            setSingleMeta("name", "description", desc);
            
            setSingleMeta("property", "og:title", flag.title_md);
            setSingleMeta("property", "og:description", desc);
            setSingleMeta("property", "og:description", imageSrc);
            
            setSingleMeta("name", "twitter:title", flag.title_md);
            setSingleMeta("name", "twitter:description", desc);
            setSingleMeta("name", "twitter:card", imageSrc);
        }

        function setSingleMeta(attr, attrValue, content) {
            $(`meta[${attr}="${attrValue}"]`).remove();
            $(`head`).prepend(`<meta ${attr}="${attrValue}" content="${content}">`);
        }

        function appendImage(image, config) {
            var path = config.dir + image.en + ".png";
            var text = image.title_md;
            // var childrenCount = getFlagChildrenCount(image.en);
            // var childrenCountHtml = childrenCount > 0 ? `<span class="ms-2">[${childrenCount}]</span>` : "";

            $(`<div class="text-center p-3 hover-zoom">
                    <img src="${path}" class="${config.imageClasses} mw-100 h-auto" data-title="${image.en}" data-type="${config.type}" width="${config.width}" height="${config.height}">
                    <br>
                    <div class="noto-sans-tc fw-800 text-secondary pt-2">
                        <a class="text-secondary" href="/flag-detail.html?name=${image.en}">${text}</a>
                    </div>
                </div>`
            ).appendTo(config.container);
        }
    </script>
</body>
</html>